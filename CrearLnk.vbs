set objWSHShell = CreateObject("WScript.Shell")
' command line arguments
' TODO: error checking
' v3.0 CrearLnk.vbs "%userprofile%\Desktop\QuitarMalware.lnk" D:\CMD\QuitarMalware.bat
' v3.5 CrearLnk.vbs "%userprofile%" D:\CMD QuitarMalware.bat
'    o CrearLnk.vbs ALLUSERSDESKTOP D:\CMD QuitarMalware.bat   

' Direccion del escritorio
if ucase(WScript.Arguments.Item(0)) = "ALLUSERSDESKTOP" then
	sDirEscrit = objWSHShell.ExpandEnvironmentStrings(objWSHShell.SpecialFolders("ALLUSERSDESKTOP")) & "\"
else
    sDirEscrit = objWSHShell.ExpandEnvironmentStrings(objWSHShell.SpecialFolders("DESKTOP")) & "\"
end if

' Ubicacion del acceso directo
sNombrelnk = sDirEscrit & left(WScript.Arguments.Item(2),len(WScript.Arguments.Item(2))-4) & ".lnk" 
' MSGBOX sNombrelnk
sShortcut = objWSHShell.ExpandEnvironmentStrings(sNombrelnk)
' sShortcut = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(0))

' Ubicacion del programa
'sTargetPath = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(1))
' MSGBOX WScript.Arguments.Item(1) & "\" & WScript.Arguments.Item(2)
sTargetPath = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(1) & "\" & WScript.Arguments.Item(2))

'Crear
set objSC = objWSHShell.CreateShortcut(sShortcut) 
'Direccion del programa
objSC.TargetPath = sTargetPath
objSC.WorkingDirectory = WScript.Arguments.Item(1)

'Guardar
objSC.Save
